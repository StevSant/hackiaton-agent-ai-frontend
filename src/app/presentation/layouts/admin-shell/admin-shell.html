<div class="flex min-h-screen">
  <!-- Overlay for small screens when sidebar is open -->
  @if (!sidebarCollapsed()) {
    <button
      class="fixed inset-0 bg-black/50 backdrop-blur-md z-30 md:hidden sidebar-overlay"
      (click)="toggleSidebar()"
      aria-label="Close sidebar overlay"
    ></button>
  }
  <aside
    class="transition-all duration-300 ease-in-out border-r surface-clear admin-shell-sidebar p-6 flex flex-col z-40 transform w-72 md:w-72 fixed md:static inset-y-0 left-0"
    [class.-translate-x-full]="sidebarCollapsed()"
    (click)="$event.stopPropagation()"
    (keydown.escape)="profileMenuOpen.set(false)"
  >
    <div class="flex-1 overflow-y-auto">
      <div class="admin-header">
        <div class="text-sm font-semibold text-center">
          <mat-icon class="text-lg mb-1">admin_panel_settings</mat-icon>
          <div>{{ "ADMIN.SIDENAV.HEADER" | translate }}</div>
        </div>
      </div>
      <nav class="flex flex-col gap-1">
        <a
          [routerLink]="['/admin']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="dashboard" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{
            "ADMIN.SIDENAV.DASHBOARD" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/users']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="group" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{ "ADMIN.SIDENAV.USERS" | translate }}</span></a
        >
        <a
          [routerLink]="['/admin/files']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="folder" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{ "ADMIN.SIDENAV.FILES" | translate }}</span></a
        >
        <a
          [routerLink]="['/admin/messages']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="sms" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{
            "ADMIN.SIDENAV.MESSAGES" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/app-info']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="info" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{
            "ADMIN.SIDENAV.APP_INFO" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/companies']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start group"
          ><mat-icon fontIcon="business" class="text-lg"></mat-icon
          ><span class="ml-3 font-medium">{{
            "ADMIN.SIDENAV.COMPANIES" | translate
          }}</span></a
        >
      </nav>
    </div>

    <!-- Footer: reusable profile menu with quick nav (Home + Back to Chat) -->
    <div
      class="pt-4 border-t space-y-3 sidebar-footer"
      style="border-color: hsl(var(--border))"
    >
      <app-profile-menu
        [showBackToChat]="true"
        [showBackHome]="true"
      ></app-profile-menu>
    </div>
  </aside>
  <main class="flex-1 overflow-y-auto">
    <div class="sticky top-0 z-10 bg-transparent p-3 md:hidden">
      <button class="btn btn-ghost btn-sm mobile-menu-btn" (click)="toggleSidebar($event)">
        <mat-icon fontIcon="menu" class="text-lg"></mat-icon>
        <span class="ml-2 font-medium">Menu</span>
      </button>
    </div>
    <router-outlet />
  </main>
</div>
