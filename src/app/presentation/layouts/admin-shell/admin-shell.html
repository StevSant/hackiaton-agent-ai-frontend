<div class="flex min-h-screen">
  <!-- Overlay for small screens when sidebar is open -->
  @if (!sidebarCollapsed()) {
  <button
    class="fixed inset-0 bg-black/30 backdrop-blur-sm z-30 md:hidden"
    (click)="toggleSidebar()"
    aria-label="Close sidebar overlay"
  ></button>
  }
  <aside
    class="transition-all duration-200 ease-in-out border-r surface-clear p-4 flex flex-col z-40 transform w-72 md:w-72 fixed md:static inset-y-0 left-0 bg-card/90 backdrop-blur"
    [class.-translate-x-full]="sidebarCollapsed()"
    (click)="$event.stopPropagation()"
    (keydown.escape)="profileMenuOpen.set(false)"
  >
    <div class="flex-1 overflow-y-auto">
      <div class="text-sm opacity-70 px-1 mb-2">
        {{ "ADMIN.SIDENAV.HEADER" | translate }}
      </div>
      <nav class="flex flex-col gap-2">
        <a
          [routerLink]="['/admin']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="dashboard"></mat-icon
          ><span class="ml-2">{{
            "ADMIN.SIDENAV.DASHBOARD" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/users']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="group"></mat-icon
          ><span class="ml-2">{{ "ADMIN.SIDENAV.USERS" | translate }}</span></a
        >
        <a
          [routerLink]="['/admin/files']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="folder"></mat-icon
          ><span class="ml-2">{{ "ADMIN.SIDENAV.FILES" | translate }}</span></a
        >
        <a
          [routerLink]="['/admin/messages']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="sms"></mat-icon
          ><span class="ml-2">{{
            "ADMIN.SIDENAV.MESSAGES" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/app-info']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="info"></mat-icon
          ><span class="ml-2">{{
            "ADMIN.SIDENAV.APP_INFO" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/risk-weights']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="science"></mat-icon
          ><span class="ml-2">{{
            "ADMIN.SIDENAV.RISK_WEIGHTS" | translate
          }}</span></a
        >
        <a
          [routerLink]="['/admin/companies']"
          routerLinkActive="active"
          class="btn btn-ghost btn-sm justify-start"
          ><mat-icon fontIcon="business"></mat-icon
          ><span class="ml-2">{{
            "ADMIN.SIDENAV.COMPANIES" | translate
          }}</span></a
        >
      </nav>
    </div>

    <!-- Footer: reusable profile menu with quick nav (Home + Back to Chat) -->
    <div
      class="pt-3 border-t space-y-2"
      style="border-color: hsl(var(--border))"
    >
      <app-profile-menu
        [showBackToChat]="true"
        [showBackHome]="true"
      ></app-profile-menu>
    </div>
  </aside>
  <main class="flex-1 overflow-y-auto">
    <div class="sticky top-0 z-10 bg-transparent p-2 md:hidden">
      <button class="btn btn-ghost btn-sm" (click)="toggleSidebar($event)">
        <mat-icon fontIcon="menu"></mat-icon>
        <span class="ml-1">Menu</span>
      </button>
    </div>
    <router-outlet />
  </main>
</div>
