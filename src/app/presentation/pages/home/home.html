<!-- Public Home page -->
<div class="min-h-dvh overflow-x-hidden relative bg-home vt-page text-[15px]">
  <!-- Header fijo -->
  <header
    class="sticky top-0 z-40 bg-base-100/80 backdrop-blur border-b border-base-200"
  >
    <div class="mx-auto max-w-7xl px-5 py-3 flex items-center justify-between">
      <!-- Marca -->
      <a
        routerLink="/"
        class="flex items-center gap-3 focus:outline-none focus:ring-2 focus:ring-primary rounded"
      >
        <img
          [src]="
            (info()?.site_icon || info()?.site_logo) ?? '/assets/favicon.ico'
          "
          [alt]="info()?.site_name || ('SHELL.APP_TITLE' | translate)"
          class="w-12 h-12 rounded object-cover"
        />
        <span class="font-bold tracking-tight text-xl md:text-2xl">
          {{ info()?.site_name || ("SHELL.APP_TITLE" | translate) }}
        </span>
      </a>

      <!-- Navegación primaria -->
      <nav
        class="flex items-center gap-2"
        [attr.aria-label]="'COMMON.PRIMARY_NAV' | translate"
      >
        @if (isAdmin()) {
          <a
            routerLink="/admin"
            routerLinkActive="btn-primary"
            class="btn btn-sm btn-ghost focus:outline-none focus:ring-2 focus:ring-primary hover:bg-primary/10"
            [attr.aria-label]="'COMMON.ADMIN' | translate"
          >
            <mat-icon
              fontIcon="admin_panel_settings"
              class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
              aria-hidden="true"
            ></mat-icon>
            <span class="ml-1">{{ "COMMON.ADMIN" | translate }}</span>
          </a>
        }
        <a
          routerLink="/chat"
          routerLinkActive="btn-primary"
          class="btn btn-sm btn-ghost focus:outline-none focus:ring-2 focus:ring-primary"
          [attr.aria-label]="'COMMON.OPEN' | translate"
        >
          <mat-icon
            fontIcon="chat"
            class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
            aria-hidden="true"
          ></mat-icon>
          <span class="ml-1">{{ "COMMON.OPEN" | translate }}</span>
        </a>
      </nav>
    </div>
  </header>

  <!-- Contenido principal -->
  <main id="main" class="mx-auto max-w-7xl px-5 py-6 md:py-8">
    <!-- Hero -->
    <section class="grid gap-3">
      <h1
        class="text-3xl md:text-5xl font-semibold tracking-tight k-gradient-title leading-tight pb-2"
      >
        {{ "HOME.TITLE" | translate }}
      </h1>
      <p class="max-w-2xl text-sm md:text-base opacity-80">
        {{ "HOME.SUBTITLE" | translate }}
      </p>
    </section>

    <!-- KPIs -->
    <section class="mt-6 md:mt-8" aria-labelledby="kpi-title">
      <h2 id="kpi-title" class="sr-only">
        {{ "HOME.KPI_SECTION" | translate }}
      </h2>
      <dl class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
        <div
          class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1 focus-within:ring-2 focus-within:ring-primary"
        >
          <div class="flex items-center justify-between">
            <dt class="text-xs opacity-70">
              {{ "HOME.KPI_SPEED" | translate }}
            </dt>
            <mat-icon
              fontIcon="bolt"
              class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
              aria-hidden="true"
            ></mat-icon>
          </div>
          <dd
            class="mt-2 text-2xl font-semibold"
            [attr.aria-label]="'HOME.KPI_SPEED' | translate"
          >
            {{ kpiSpeedDisplay() }}
          </dd>
          <p class="text-xs opacity-60 mt-1">
            {{ "HOME.KPI_SPEED_HINT" | translate }}
          </p>
        </div>

        <div
          class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1 focus-within:ring-2 focus-within:ring-primary"
        >
          <div class="flex items-center justify-between">
            <dt class="text-xs opacity-70">
              {{ "HOME.KPI_APPROVAL" | translate }}
            </dt>
            <mat-icon
              fontIcon="thumb_up"
              class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
              aria-hidden="true"
            ></mat-icon>
          </div>
          <dd class="mt-2 text-2xl font-semibold">
            {{ kpiApprovalDisplay() }}
          </dd>
          <p class="text-xs opacity-60 mt-1">
            {{ "HOME.KPI_APPROVAL_HINT" | translate }}
          </p>
        </div>

        <div
          class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1 focus-within:ring-2 focus-within:ring-primary"
        >
          <div class="flex items-center justify-between">
            <dt class="text-xs opacity-70">
              {{ "HOME.KPI_OBJECTIVITY" | translate }}
            </dt>
            <mat-icon
              fontIcon="insights"
              class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
              aria-hidden="true"
            ></mat-icon>
          </div>
          <dd class="mt-2 text-2xl font-semibold">
            {{ kpiObjectivityDisplay() }}
          </dd>
          <p class="text-xs opacity-60 mt-1">
            {{ "HOME.KPI_OBJECTIVITY_HINT" | translate }}
          </p>
        </div>

        <div
          class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1 focus-within:ring-2 focus-within:ring-primary"
        >
          <div class="flex items-center justify-between">
            <dt class="text-xs opacity-70">
              {{ "HOME.KPI_TIME" | translate }}
            </dt>
            <mat-icon
              fontIcon="timer"
              class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
              aria-hidden="true"
            ></mat-icon>
          </div>
          <dd class="mt-2 text-2xl font-semibold">
            {{ kpiTimeDisplay() }}
          </dd>
          <p class="text-xs opacity-60 mt-1">
            {{ "HOME.KPI_TIME_HINT" | translate }}
          </p>
        </div>
      </dl>
    </section>

    <!-- Gráficos -->
    <section
      class="mt-8 md:mt-10 grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"
    >
      <figure
        class="glass-card p-4 lg:col-span-2 min-h-[260px] rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <div class="flex items-center justify-between">
          <h3 class="font-medium" id="speedChartTitle">
            {{ "HOME.MKT.SPEED_TITLE" | translate }}
          </h3>
          <mat-icon
            fontIcon="show_chart"
            class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
            aria-hidden="true"
          ></mat-icon>
        </div>
        <p class="mt-3 text-xs opacity-70" id="speedChartDesc">
          {{ "HOME.MKT.SPEED_DESC" | translate }}
        </p>
        <app-lazy-chart
          class="mt-3"
          [chartType]="'line'"
          [data]="speedChartData()"
          [options]="{
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'bottom' } },
            scales: {
              x: { grid: { display: false } },
              y: {
                beginAtZero: true,
                grid: { color: 'rgba(255,255,255,0.08)' },
              },
            },
          }"
          [ariaLabelledby]="'speedChartTitle speedChartDesc'"
        ></app-lazy-chart>
        <figcaption class="sr-only">
          {{ "HOME.MKT.SPEED_DESC" | translate }}
        </figcaption>
      </figure>

      <figure
        class="glass-card p-4 min-h-[260px] rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <div class="flex items-center justify-between">
          <h3 class="font-medium" id="resultsChartTitle">
            {{ "HOME.MKT.RESULTS_TITLE" | translate }}
          </h3>
          <mat-icon
            fontIcon="donut_small"
            class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
            aria-hidden="true"
          ></mat-icon>
        </div>
        <p class="mt-3 text-xs opacity-70" id="resultsChartDesc">
          {{ "HOME.MKT.RESULTS_DESC" | translate }}
        </p>
        <app-lazy-chart
          class="mt-3"
          [chartType]="'doughnut'"
          [data]="approvalsChartData()"
          [options]="{
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'bottom' } },
          }"
          [ariaLabelledby]="'resultsChartTitle resultsChartDesc'"
        ></app-lazy-chart>
        <figcaption class="sr-only">
          {{ "HOME.MKT.RESULTS_DESC" | translate }}
        </figcaption>
      </figure>
    </section>

    <!-- Texto explicativo -->
    <section class="px-0 mt-6 grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6">
      <figure
        class="glass-card p-4 min-h-[260px] lg:col-span-1 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <div class="flex items-center justify-between">
          <h3 class="font-medium" id="totalTimeChartTitle">
            {{ "HOME.MKT.TOTAL_TIME_TITLE" | translate }}
          </h3>
          <mat-icon
            fontIcon="timer"
            class="opacity-80 transition-colors duration-300 ease-out hover:text-primary"
            aria-hidden="true"
          ></mat-icon>
        </div>
        <p class="mt-3 text-xs opacity-70" id="totalTimeChartDesc">
          {{ "HOME.MKT.TOTAL_TIME_DESC" | translate }}
        </p>
        <app-lazy-chart
          class="mt-3"
          [chartType]="'bar'"
          [data]="totalTimeChartData()"
          [options]="{
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true } },
          }"
          [ariaLabelledby]="'totalTimeChartTitle totalTimeChartDesc'"
        ></app-lazy-chart>
        <figcaption class="sr-only">
          {{ "HOME.MKT.TOTAL_TIME_DESC" | translate }}
        </figcaption>
      </figure>

      <article
        class="glass-card p-4 lg:col-span-2 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <h3 class="font-medium">{{ "HOME.MKT.RETO_TITLE" | translate }}</h3>
        <div class="mt-3 space-y-3 text-sm opacity-90 leading-relaxed">
          <p>{{ "HOME.MKT.OBJETIVO_INTRO" | translate }}</p>
          <p>{{ "HOME.MKT.IMPORTA_INTRO" | translate }}</p>
          <ul class="list-disc ml-5 opacity-90 marker:opacity-60 space-y-1">
            <li>{{ "HOME.MKT.BULLET1" | translate }}</li>
            <li>{{ "HOME.MKT.BULLET2" | translate }}</li>
            <li>{{ "HOME.MKT.BULLET3" | translate }}</li>
            <li>{{ "HOME.MKT.BULLET4" | translate }}</li>
          </ul>
        </div>
      </article>
    </section>

    <section class="mt-6 grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
      <article
        class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <h3 class="font-medium">{{ "HOME.MKT.IA_TITLE" | translate }}</h3>
        <div class="mt-3 text-sm opacity-90 leading-relaxed space-y-2">
          <p>{{ "HOME.MKT.IA_P1" | translate }}</p>
          <p>{{ "HOME.MKT.IA_P2" | translate }}</p>
          <p>{{ "HOME.MKT.IA_P3" | translate }}</p>
          <p>{{ "HOME.MKT.IA_P4" | translate }}</p>
        </div>
      </article>

      <aside
        class="glass-card p-4 rounded-xl transition-all duration-300 ease-out hover:shadow-lg hover:shadow-primary/20 hover:-translate-y-1"
      >
        <h3 id="deliverablesTitle" class="font-medium">
          {{ "HOME.MKT.ENTREGABLES_TITLE" | translate }}
        </h3>
        <ul class="mt-3 list-disc ml-5 text-sm opacity-90 space-y-1">
          <li>{{ "HOME.MKT.ENT_ITEM1" | translate }}</li>
          <li>{{ "HOME.MKT.ENT_ITEM2" | translate }}</li>
          <li>{{ "HOME.MKT.ENT_ITEM3" | translate }}</li>
          <li>{{ "HOME.MKT.ENT_ITEM4" | translate }}</li>
        </ul>
        <p class="mt-4 text-xs opacity-70">
          {{ "HOME.MKT.DATOS_LABEL" | translate }}
        </p>
      </aside>
    </section>
  </main>

  <!-- Footer -->
  <footer class="mt-10 border-t border-base-200">
    <div
      class="mx-auto max-w-7xl px-5 py-6 text-xs opacity-70 flex flex-wrap items-center justify-between gap-2"
    >
      <span
        >© {{ info()?.site_name || ("SHELL.APP_TITLE" | translate) }} ·
        {{ today | date: "yyyy" }}</span
      >
      <a routerLink="/privacy" class="link link-hover">{{
        "COMMON.PRIVACY" | translate
      }}</a>
    </div>
  </footer>

  <!-- Menú flotante -->
  <div class="fixed bottom-4 right-4 z-50">
    <app-profile-menu
      [compact]="true"
      [attr.aria-label]="'COMMON.PROFILE_MENU' | translate"
    ></app-profile-menu>
  </div>
</div>
